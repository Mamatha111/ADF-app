/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { PeopleProcessService, UserProcessModel } from '@alfresco/adf-core';
import { AuthenticationService, CardViewUpdateService, LogService, FormRenderingService, CommentsComponent } from '@alfresco/adf-core';
import { Component, EventEmitter, Input, Output, TemplateRef, ViewChild } from '@angular/core';
import { MatDialog } from '@angular/material';
import { Observable } from 'rxjs';
import { TaskQueryRequestRepresentationModel } from '../models/filter.model';
import { TaskDetailsModel } from '../models/task-details.model';
import { TaskListService } from './../services/tasklist.service';
import { AttachFileWidgetComponent, AttachFolderWidgetComponent } from '../../content-widget';
import { share } from 'rxjs/operators';
var TaskDetailsComponent = /** @class */ (function () {
    function TaskDetailsComponent(taskListService, authService, peopleProcessService, formRenderingService, logService, cardViewUpdateService, dialog) {
        var _this = this;
        this.taskListService = taskListService;
        this.authService = authService;
        this.peopleProcessService = peopleProcessService;
        this.formRenderingService = formRenderingService;
        this.logService = logService;
        this.cardViewUpdateService = cardViewUpdateService;
        this.dialog = dialog;
        /**
         * Toggles debug mode.
         */
        this.debugMode = false;
        /**
         * Automatically renders the next task when the current one is completed.
         */
        this.showNextTask = true;
        /**
         * Toggles task details Header component.
         */
        this.showHeader = true;
        /**
         * Toggles collapsed/expanded state of the Header component.
         */
        this.showHeaderContent = true;
        /**
         * Toggles `Involve People` feature for the Header component.
         */
        this.showInvolvePeople = true;
        /**
         * Toggles `Comments` feature for the Header component.
         */
        this.showComments = true;
        /**
         * Toggles `Checklist` feature for the Header component.
         */
        this.showChecklist = true;
        /**
         * Toggles rendering of the form title.
         */
        this.showFormTitle = false;
        /**
         * Toggles rendering of the `Complete` outcome button.
         */
        this.showFormCompleteButton = true;
        /**
         * Toggles rendering of the `Save` outcome button.
         */
        this.showFormSaveButton = true;
        /**
         * Toggles read-only state of the form. All form widgets render as read-only
         * if enabled.
         */
        this.readOnlyForm = false;
        /**
         * Toggles rendering of the `Refresh` button.
         */
        this.showFormRefreshButton = true;
        /**
         * Field validators for use with the form.
         */
        this.fieldValidators = [];
        /**
         * Emitted when the form is submitted with the `Save` or custom outcomes.
         */
        this.formSaved = new EventEmitter();
        /**
         * Emitted when the form is submitted with the `Complete` outcome.
         */
        this.formCompleted = new EventEmitter();
        /**
         * Emitted when the form field content is clicked.
         */
        this.formContentClicked = new EventEmitter();
        /**
         * Emitted when the form is loaded or reloaded.
         */
        this.formLoaded = new EventEmitter();
        /**
         * Emitted when a checklist task is created.
         */
        this.taskCreated = new EventEmitter();
        /**
         * Emitted when a checklist task is deleted.
         */
        this.taskDeleted = new EventEmitter();
        /**
         * Emitted when an error occurs.
         */
        this.error = new EventEmitter();
        /**
         * Emitted when any outcome is executed. Default behaviour can be prevented
         * via `event.preventDefault()`.
         */
        this.executeOutcome = new EventEmitter();
        /**
         * Emitted when a task is assigned.
         */
        this.assignTask = new EventEmitter();
        /**
         * Emitted when a task is claimed.
         */
        this.claimedTask = new EventEmitter();
        /**
         * Emitted when a task is unclaimed.
         */
        this.unClaimedTask = new EventEmitter();
        this.taskFormName = null;
        this.taskPeople = [];
        this.showAssignee = false;
        this.showAttachForm = false;
        this.internalReadOnlyForm = false;
        this.formRenderingService.setComponentTypeResolver('select-folder', function () { return AttachFolderWidgetComponent; }, true);
        this.formRenderingService.setComponentTypeResolver('upload', function () { return AttachFileWidgetComponent; }, true);
        this.peopleSearch = new Observable(function (observer) { return _this.peopleSearchObserver = observer; })
            .pipe(share());
        this.authService.getBpmLoggedUser().subscribe(function (user) {
            _this.currentLoggedUser = user;
        });
    }
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        if (this.taskId) {
            this.loadDetails(this.taskId);
        }
        this.cardViewUpdateService.itemUpdated$.subscribe(this.updateTaskDetails.bind(this));
        this.cardViewUpdateService.itemClicked$.subscribe(this.clickTaskDetails.bind(this));
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    TaskDetailsComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        /** @type {?} */
        var taskId = changes.taskId;
        this.showAssignee = false;
        if (taskId && !taskId.currentValue) {
            this.reset();
        }
        else if (taskId && taskId.currentValue) {
            this.loadDetails(taskId.currentValue);
        }
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isStandaloneTask = /**
     * @return {?}
     */
    function () {
        return !(this.taskDetails && (!!this.taskDetails.processDefinitionId));
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isStandaloneTaskWithForm = /**
     * @return {?}
     */
    function () {
        return this.isStandaloneTask() && this.hasFormKey();
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isStandaloneTaskWithoutForm = /**
     * @return {?}
     */
    function () {
        return this.isStandaloneTask() && !this.hasFormKey();
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isFormComponentVisible = /**
     * @return {?}
     */
    function () {
        return this.hasFormKey() && !this.isShowAttachForm();
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isTaskStandaloneComponentVisible = /**
     * @return {?}
     */
    function () {
        return this.isStandaloneTaskWithoutForm() && !this.isShowAttachForm();
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isShowAttachForm = /**
     * @return {?}
     */
    function () {
        return this.showAttachForm;
    };
    /**
     * Reset the task details
     */
    /**
     * Reset the task details
     * @private
     * @return {?}
     */
    TaskDetailsComponent.prototype.reset = /**
     * Reset the task details
     * @private
     * @return {?}
     */
    function () {
        this.taskDetails = null;
    };
    /**
     * Check if the task has a form
     */
    /**
     * Check if the task has a form
     * @return {?}
     */
    TaskDetailsComponent.prototype.hasFormKey = /**
     * Check if the task has a form
     * @return {?}
     */
    function () {
        return (this.taskDetails && (!!this.taskDetails.formKey));
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isTaskActive = /**
     * @return {?}
     */
    function () {
        return this.taskDetails && this.taskDetails.duration === null;
    };
    /**
     * Save a task detail and update it after a successful response
     *
     * @param updateNotification
     */
    /**
     * Save a task detail and update it after a successful response
     *
     * @private
     * @param {?} updateNotification
     * @return {?}
     */
    TaskDetailsComponent.prototype.updateTaskDetails = /**
     * Save a task detail and update it after a successful response
     *
     * @private
     * @param {?} updateNotification
     * @return {?}
     */
    function (updateNotification) {
        var _this = this;
        this.taskListService.updateTask(this.taskId, updateNotification.changed)
            .subscribe(function () {
            _this.loadDetails(_this.taskId);
        });
    };
    /**
     * @private
     * @param {?} clickNotification
     * @return {?}
     */
    TaskDetailsComponent.prototype.clickTaskDetails = /**
     * @private
     * @param {?} clickNotification
     * @return {?}
     */
    function (clickNotification) {
        if (clickNotification.target.key === 'assignee') {
            this.showAssignee = true;
        }
        if (clickNotification.target.key === 'formName') {
            this.showAttachForm = true;
        }
    };
    /**
     * Load the activiti task details
     * @param taskId
     */
    /**
     * Load the activiti task details
     * @private
     * @param {?} taskId
     * @return {?}
     */
    TaskDetailsComponent.prototype.loadDetails = /**
     * Load the activiti task details
     * @private
     * @param {?} taskId
     * @return {?}
     */
    function (taskId) {
        var _this = this;
        this.taskPeople = [];
        this.taskFormName = null;
        if (taskId) {
            this.taskListService.getTaskDetails(taskId).subscribe(function (res) {
                _this.showAttachForm = false;
                _this.taskDetails = res;
                if (_this.taskDetails.name === 'null') {
                    _this.taskDetails.name = 'No name';
                }
                /** @type {?} */
                var endDate = res.endDate;
                if (endDate && !isNaN(endDate.getTime())) {
                    _this.internalReadOnlyForm = true;
                }
                else {
                    _this.internalReadOnlyForm = _this.readOnlyForm;
                }
                if (_this.taskDetails && _this.taskDetails.involvedPeople) {
                    _this.taskDetails.involvedPeople.forEach(function (user) {
                        _this.taskPeople.push(new UserProcessModel(user));
                    });
                }
            });
        }
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isAssigned = /**
     * @return {?}
     */
    function () {
        return !!this.taskDetails.assignee;
    };
    /**
     * @private
     * @return {?}
     */
    TaskDetailsComponent.prototype.hasEmailAddress = /**
     * @private
     * @return {?}
     */
    function () {
        return this.taskDetails.assignee.email ? true : false;
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isAssignedToMe = /**
     * @return {?}
     */
    function () {
        return this.isAssigned() && this.hasEmailAddress() ?
            this.isEmailEqual(this.taskDetails.assignee.email, this.currentLoggedUser.email) :
            this.isExternalIdEqual(this.taskDetails.assignee.externalId, this.currentLoggedUser.externalId);
    };
    /**
     * @private
     * @param {?} assigneeMail
     * @param {?} currentLoggedEmail
     * @return {?}
     */
    TaskDetailsComponent.prototype.isEmailEqual = /**
     * @private
     * @param {?} assigneeMail
     * @param {?} currentLoggedEmail
     * @return {?}
     */
    function (assigneeMail, currentLoggedEmail) {
        return assigneeMail.toLocaleLowerCase() === currentLoggedEmail.toLocaleLowerCase();
    };
    /**
     * @private
     * @param {?} assigneeExternalId
     * @param {?} currentUserExternalId
     * @return {?}
     */
    TaskDetailsComponent.prototype.isExternalIdEqual = /**
     * @private
     * @param {?} assigneeExternalId
     * @param {?} currentUserExternalId
     * @return {?}
     */
    function (assigneeExternalId, currentUserExternalId) {
        return assigneeExternalId.toLocaleLowerCase() === currentUserExternalId.toLocaleLowerCase();
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isCompleteButtonEnabled = /**
     * @return {?}
     */
    function () {
        return this.isAssignedToMe() || this.canInitiatorComplete();
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isCompleteButtonVisible = /**
     * @return {?}
     */
    function () {
        return !this.hasFormKey() && this.isTaskActive() && this.isCompleteButtonEnabled();
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.canInitiatorComplete = /**
     * @return {?}
     */
    function () {
        return this.taskDetails.initiatorCanCompleteTask;
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isSaveButtonVisible = /**
     * @return {?}
     */
    function () {
        return this.hasSaveButton() && (!this.canInitiatorComplete() || this.isAssignedToMe());
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.hasSaveButton = /**
     * @return {?}
     */
    function () {
        return this.showFormSaveButton;
    };
    /**
     * Retrieve the next open task
     * @param processInstanceId
     * @param processDefinitionId
     */
    /**
     * Retrieve the next open task
     * @private
     * @param {?} processInstanceId
     * @param {?} processDefinitionId
     * @return {?}
     */
    TaskDetailsComponent.prototype.loadNextTask = /**
     * Retrieve the next open task
     * @private
     * @param {?} processInstanceId
     * @param {?} processDefinitionId
     * @return {?}
     */
    function (processInstanceId, processDefinitionId) {
        var _this = this;
        /** @type {?} */
        var requestNode = new TaskQueryRequestRepresentationModel({
            processInstanceId: processInstanceId,
            processDefinitionId: processDefinitionId
        });
        this.taskListService.getTasks(requestNode).subscribe(function (response) {
            if (response && response.length > 0) {
                _this.taskDetails = new TaskDetailsModel(response[0]);
            }
            else {
                _this.reset();
            }
        }, function (error) {
            _this.error.emit(error);
        });
    };
    /**
     * Complete button clicked
     */
    /**
     * Complete button clicked
     * @return {?}
     */
    TaskDetailsComponent.prototype.onComplete = /**
     * Complete button clicked
     * @return {?}
     */
    function () {
        var _this = this;
        this.taskListService.completeTask(this.taskId).subscribe(function (res) { return _this.onFormCompleted(null); });
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.onShowAttachForm = /**
     * @return {?}
     */
    function () {
        this.showAttachForm = true;
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.onCancelAttachForm = /**
     * @return {?}
     */
    function () {
        this.showAttachForm = false;
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.onCompleteAttachForm = /**
     * @return {?}
     */
    function () {
        this.showAttachForm = false;
        this.loadDetails(this.taskId);
    };
    /**
     * @param {?} content
     * @return {?}
     */
    TaskDetailsComponent.prototype.onFormContentClick = /**
     * @param {?} content
     * @return {?}
     */
    function (content) {
        this.formContentClicked.emit(content);
    };
    /**
     * @param {?} form
     * @return {?}
     */
    TaskDetailsComponent.prototype.onFormSaved = /**
     * @param {?} form
     * @return {?}
     */
    function (form) {
        this.formSaved.emit(form);
    };
    /**
     * @param {?} form
     * @return {?}
     */
    TaskDetailsComponent.prototype.onFormCompleted = /**
     * @param {?} form
     * @return {?}
     */
    function (form) {
        this.formCompleted.emit(form);
        if (this.showNextTask && (this.taskDetails.processInstanceId || this.taskDetails.processDefinitionId)) {
            this.loadNextTask(this.taskDetails.processInstanceId, this.taskDetails.processDefinitionId);
        }
    };
    /**
     * @param {?} form
     * @return {?}
     */
    TaskDetailsComponent.prototype.onFormLoaded = /**
     * @param {?} form
     * @return {?}
     */
    function (form) {
        this.taskFormName = (form && form.name ? form.name : null);
        this.formLoaded.emit(form);
    };
    /**
     * @param {?} task
     * @return {?}
     */
    TaskDetailsComponent.prototype.onChecklistTaskCreated = /**
     * @param {?} task
     * @return {?}
     */
    function (task) {
        this.taskCreated.emit(task);
    };
    /**
     * @param {?} taskId
     * @return {?}
     */
    TaskDetailsComponent.prototype.onChecklistTaskDeleted = /**
     * @param {?} taskId
     * @return {?}
     */
    function (taskId) {
        this.taskDeleted.emit(taskId);
    };
    /**
     * @param {?} error
     * @return {?}
     */
    TaskDetailsComponent.prototype.onFormError = /**
     * @param {?} error
     * @return {?}
     */
    function (error) {
        this.errorDialogRef = this.dialog.open(this.errorDialog, { width: '500px' });
        this.error.emit(error);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    TaskDetailsComponent.prototype.onFormExecuteOutcome = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.executeOutcome.emit(event);
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.closeErrorDialog = /**
     * @return {?}
     */
    function () {
        this.dialog.closeAll();
    };
    /**
     * @param {?} taskId
     * @return {?}
     */
    TaskDetailsComponent.prototype.onClaimAction = /**
     * @param {?} taskId
     * @return {?}
     */
    function (taskId) {
        this.claimedTask.emit(taskId);
        this.loadDetails(taskId);
    };
    /**
     * @param {?} taskId
     * @return {?}
     */
    TaskDetailsComponent.prototype.onUnclaimAction = /**
     * @param {?} taskId
     * @return {?}
     */
    function (taskId) {
        this.unClaimedTask.emit(taskId);
        this.loadDetails(taskId);
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isCompletedTask = /**
     * @return {?}
     */
    function () {
        return this.taskDetails && this.taskDetails.endDate ? true : undefined;
    };
    /**
     * @param {?} searchedWord
     * @return {?}
     */
    TaskDetailsComponent.prototype.searchUser = /**
     * @param {?} searchedWord
     * @return {?}
     */
    function (searchedWord) {
        var _this = this;
        this.peopleProcessService.getWorkflowUsers(null, searchedWord)
            .subscribe(function (users) {
            users = users.filter(function (user) { return user.id !== _this.taskDetails.assignee.id; });
            _this.peopleSearchObserver.next(users);
        }, function (error) { return _this.logService.error('Could not load users'); });
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.onCloseSearch = /**
     * @return {?}
     */
    function () {
        this.showAssignee = false;
    };
    /**
     * @param {?} selectedUser
     * @return {?}
     */
    TaskDetailsComponent.prototype.assignTaskToUser = /**
     * @param {?} selectedUser
     * @return {?}
     */
    function (selectedUser) {
        var _this = this;
        this.taskListService.assignTask(this.taskDetails.id, selectedUser).subscribe(function (res) {
            _this.logService.info('Task Assigned to ' + selectedUser.email);
            _this.assignTask.emit();
        });
        this.showAssignee = false;
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.getTaskHeaderViewClass = /**
     * @return {?}
     */
    function () {
        if (this.showAssignee) {
            return 'assign-edit-view';
        }
        else {
            return 'default-view';
        }
    };
    /**
     * @return {?}
     */
    TaskDetailsComponent.prototype.isReadOnlyComment = /**
     * @return {?}
     */
    function () {
        return (this.taskDetails && this.taskDetails.isCompleted()) && (this.taskPeople && this.taskPeople.length === 0);
    };
    TaskDetailsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'adf-task-details',
                    template: "<div *ngIf=\"!taskDetails\" data-automation-id=\"adf-tasks-details--empty\">\n    <ng-template *ngIf=\"noTaskDetailsTemplateComponent\" ngFor [ngForOf]=\"[data]\"\n                 [ngForTemplate]=\"noTaskDetailsTemplateComponent\">\n        {{ 'ADF_TASK_LIST.DETAILS.MESSAGES.NONE' | translate }}\n    </ng-template>\n    <div *ngIf=\"!noTaskDetailsTemplateComponent\">\n        {{ 'ADF_TASK_LIST.DETAILS.MESSAGES.NONE' | translate }}\n    </div>\n</div>\n<div *ngIf=\"taskDetails\" class=\"adf-task-details\">\n\n    <div *ngIf=\"showHeader\" class=\"adf-task-details-header\">\n        <h2 class=\"adf-activiti-task-details__header\">\n            <span>{{taskDetails.name || 'No name'}}</span>\n        </h2>\n    </div>\n\n    <div class=\"adf-task-details-core\"\n        fxLayout=\"column\"\n        fxLayoutGap=\"8px\"\n        fxLayout.lt-lg=\"column\">\n\n        <div class=\"adf-task-details-core-form\">\n            <div *ngIf=\"isAssigned()\">\n                <adf-form *ngIf=\"isFormComponentVisible()\" #activitiForm\n                          [showDebugButton]=\"debugMode\"\n                          [taskId]=\"taskDetails.id\"\n                          [showTitle]=\"showFormTitle\"\n                          [showRefreshButton]=\"showFormRefreshButton\"\n                          [showCompleteButton]=\"showFormCompleteButton\"\n                          [disableCompleteButton]=\"!isCompleteButtonEnabled()\"\n                          [showSaveButton]=\"isSaveButtonVisible()\"\n                          [readOnly]=\"internalReadOnlyForm\"\n                          [fieldValidators]=\"fieldValidators\"\n                          (formSaved)='onFormSaved($event)'\n                          (formCompleted)='onFormCompleted($event)'\n                          (formContentClicked)='onFormContentClick($event)'\n                          (formLoaded)='onFormLoaded($event)'\n                          (error)='onFormError($event)'\n                          (executeOutcome)='onFormExecuteOutcome($event)'>\n                </adf-form>\n                <adf-task-standalone *ngIf=\"isTaskStandaloneComponentVisible()\"\n                                     [taskName]=\"taskDetails.name\"\n                                     [taskId]=\"taskDetails.id\"\n                                     [isCompleted]=\"isCompletedTask()\"\n                                     [hasCompletePermission]=\"isCompleteButtonEnabled()\"\n                                     [hideCancelButton]=\"true\"\n                                     (complete)=\"onComplete()\"\n                                     (showAttachForm)=\"onShowAttachForm()\">\n                </adf-task-standalone>\n\n                <mat-card class=\"adf-message-card\" *ngIf=\"!isTaskStandaloneComponentVisible() && !isCompletedTask() && !isFormComponentVisible()\" >\n                    <mat-card-content>\n                        <div class=\"adf-no-form-message-container\">\n                            <div class=\"adf-no-form-message-list\">\n                                <div *ngIf=\"!isCompletedTask()\" class=\"adf-no-form-message\">\n                                    <span id=\"adf-no-form-message\">{{'ADF_TASK_LIST.STANDALONE_TASK.NO_FORM_MESSAGE' | translate}}</span>\n                                </div>\n                            </div>\n                        </div>\n                    </mat-card-content>\n\n                    <mat-card-actions class=\"adf-no-form-mat-card-actions\">\n                        <div>\n                            <button mat-button id=\"adf-no-form-complete-button\" color=\"primary\" (click)=\"onComplete()\">{{ 'ADF_TASK_LIST.DETAILS.BUTTON.COMPLETE' | translate }}</button>\n                        </div>\n                    </mat-card-actions>\n\n                </mat-card>\n\n                <adf-attach-form *ngIf=\"isShowAttachForm()\"\n                                 [taskId]=\"taskDetails.id\"\n                                 [formKey]=\"taskDetails.formKey\"\n                                 (cancelAttachForm)=\"onCancelAttachForm()\"\n                                 (success)=\"onCompleteAttachForm()\">\n                </adf-attach-form>\n            </div>\n            <div *ngIf=\"!isAssigned()\" id=\"claim-message-id\">\n                {{ 'ADF_TASK_LIST.DETAILS.MESSAGES.CLAIM' | translate }}\n            </div>\n        </div>\n        <div class=\"adf-task-details-core-sidebar\">\n            <adf-info-drawer *ngIf=\"showHeaderContent\" title=\"{{ 'ADF_TASK_LIST.DETAILS.LABELS.INFO_DRAWER_TITLE' | translate }}\" id=\"adf-task-details-core-sidebar-drawer\" class=\"adf-task-details-core-sidebar-drawer\">\n                <adf-info-drawer-tab label=\"{{ 'ADF_TASK_LIST.DETAILS.LABELS.INFO_DRAWER_TAB_DETAILS_TITLE' | translate }}\">\n                    <div class=\"adf-assignment-container\" *ngIf=\"showAssignee\">\n                        <adf-people-search\n                            (searchPeople)=\"searchUser($event)\"\n                            (success)=\"assignTaskToUser($event)\"\n                            (closeSearch)=\"onCloseSearch()\"\n                            [results]=\"peopleSearch\">\n                            <ng-container adf-people-search-title>{{ 'ADF_TASK_LIST.DETAILS.LABELS.ADD_ASSIGNEE' | translate }}\n                            </ng-container>\n                            <ng-container adf-people-search-action-label>{{ 'ADF_TASK_LIST.PEOPLE.ADD_ASSIGNEE' | translate }}\n                            </ng-container>\n                        </adf-people-search>\n                    </div>\n                    <adf-task-header\n                        [class]=\"getTaskHeaderViewClass()\"\n                        [taskDetails]=\"taskDetails\"\n                        [formName]=\"taskFormName\"\n                        (claim)=\"onClaimAction($event)\"\n                        (unclaim)=\"onUnclaimAction($event)\">\n                    </adf-task-header>\n                    <adf-people *ngIf=\"showInvolvePeople\" #people\n                                [people]=\"taskPeople\"\n                                [readOnly]=\"internalReadOnlyForm\"\n                                [taskId]=\"taskDetails.id\">\n                    </adf-people>\n                </adf-info-drawer-tab>\n\n                <adf-info-drawer-tab label=\"{{ 'ADF_TASK_LIST.DETAILS.LABELS.INFO_DRAWER_TAB_ACTIVITY_TITLE' | translate }}\">\n                    <mat-card *ngIf=\"showComments\">\n                        <mat-card-content>\n                            <adf-comments #activitiComments\n                                          [readOnly]=\"isReadOnlyComment()\"\n                                          [taskId]=\"taskDetails.id\">\n                            </adf-comments>\n                        </mat-card-content>\n                    </mat-card>\n                </adf-info-drawer-tab>\n\n            </adf-info-drawer>\n\n            <div *ngIf=\"showHeaderContent\" class=\"adf-task-details-core-sidebar-checklist\">\n                <div *ngIf=\"showChecklist\">\n                    <adf-checklist #activitiChecklist\n                                   [readOnly]=\"internalReadOnlyForm\"\n                                   [taskId]=\"taskDetails.id\"\n                                   [assignee]=\"taskDetails?.assignee?.id\"\n                                   (checklistTaskCreated)=\"onChecklistTaskCreated($event)\"\n                                   (checklistTaskDeleted)=\"onChecklistTaskDeleted($event)\">\n                    </adf-checklist>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <ng-template #errorDialog>\n        <h3 matDialogTitle>{{'ADF_TASK_LIST.DETAILS.ERROR.TITLE'|translate}}</h3>\n        <mat-dialog-content>\n            <p>{{'ADF_TASK_LIST.DETAILS.ERROR.DESCRIPTION'|translate}}</p>\n        </mat-dialog-content>\n        <mat-dialog-actions>\n            <button mat-button type=\"button\" (click)=\"closeErrorDialog()\">{{'ADF_TASK_LIST.DETAILS.ERROR.CLOSE'|translate}}\n            </button>\n        </mat-dialog-actions>\n    </ng-template>\n\n</div>\n",
                    styles: [":host{width:100%}.adf-error-dialog h3{margin:16px 0}.adf-activiti-task-details__header{align-self:flex-end;display:flex;font-size:24px;font-weight:300;line-height:normal;overflow:hidden;margin:8px 0 16px;cursor:pointer;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none}.adf-activiti-task-details__action-button{text-transform:uppercase}.adf-assignment-container{padding:10px 20px;width:auto}adf-task-header.adf-assign-edit-view ::ng-deep adf-card-view ::ng-deep .adf-property[data-automation-id=header-assignee]{display:none}.adf-task-details-header{display:flex;justify-content:space-between}.adf-task-details-header-toggle{position:relative;top:10px;margin-right:2px;height:23px;cursor:pointer;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none}.adf-task-details-toggle{position:relative}.adf-task-details-core{display:flex;justify-content:space-between}@media screen and (max-width:1279px){.adf-task-details-core-sidebar-drawer{margin-left:0}}.adf-task-details-core-sidebar-checklist{margin-top:30px;padding-left:20px;padding-right:20px}.adf-task-details-core-form{flex-grow:1}.adf-task-details-core-form ::ng-deep .adf-form-debug-container{display:flex;flex-direction:column;padding:20px 0}.adf-task-details-core-form ::ng-deep .adf-form-debug-container .mat-slide-toggle{margin-left:auto}.adf-task-details-core-form ::ng-deep .adf-form-debug-container .mat-slide-toggle+div{background-color:#000;padding:20px;clear:both;margin-top:30px;color:#fff}.adf-task-details-core-form ::ng-deep .mat-tab-label{flex-grow:1}"]
                }] }
    ];
    /** @nocollapse */
    TaskDetailsComponent.ctorParameters = function () { return [
        { type: TaskListService },
        { type: AuthenticationService },
        { type: PeopleProcessService },
        { type: FormRenderingService },
        { type: LogService },
        { type: CardViewUpdateService },
        { type: MatDialog }
    ]; };
    TaskDetailsComponent.propDecorators = {
        activitiComments: [{ type: ViewChild, args: ['activitiComments',] }],
        activitiChecklist: [{ type: ViewChild, args: ['activitiChecklist',] }],
        errorDialog: [{ type: ViewChild, args: ['errorDialog',] }],
        debugMode: [{ type: Input }],
        taskId: [{ type: Input }],
        showNextTask: [{ type: Input }],
        showHeader: [{ type: Input }],
        showHeaderContent: [{ type: Input }],
        showInvolvePeople: [{ type: Input }],
        showComments: [{ type: Input }],
        showChecklist: [{ type: Input }],
        showFormTitle: [{ type: Input }],
        showFormCompleteButton: [{ type: Input }],
        showFormSaveButton: [{ type: Input }],
        readOnlyForm: [{ type: Input }],
        showFormRefreshButton: [{ type: Input }],
        fieldValidators: [{ type: Input }],
        formSaved: [{ type: Output }],
        formCompleted: [{ type: Output }],
        formContentClicked: [{ type: Output }],
        formLoaded: [{ type: Output }],
        taskCreated: [{ type: Output }],
        taskDeleted: [{ type: Output }],
        error: [{ type: Output }],
        executeOutcome: [{ type: Output }],
        assignTask: [{ type: Output }],
        claimedTask: [{ type: Output }],
        unClaimedTask: [{ type: Output }]
    };
    return TaskDetailsComponent;
}());
export { TaskDetailsComponent };
if (false) {
    /** @type {?} */
    TaskDetailsComponent.prototype.activitiComments;
    /** @type {?} */
    TaskDetailsComponent.prototype.activitiChecklist;
    /** @type {?} */
    TaskDetailsComponent.prototype.errorDialog;
    /**
     * Toggles debug mode.
     * @type {?}
     */
    TaskDetailsComponent.prototype.debugMode;
    /**
     * (**required**) The id of the task whose details we are asking for.
     * @type {?}
     */
    TaskDetailsComponent.prototype.taskId;
    /**
     * Automatically renders the next task when the current one is completed.
     * @type {?}
     */
    TaskDetailsComponent.prototype.showNextTask;
    /**
     * Toggles task details Header component.
     * @type {?}
     */
    TaskDetailsComponent.prototype.showHeader;
    /**
     * Toggles collapsed/expanded state of the Header component.
     * @type {?}
     */
    TaskDetailsComponent.prototype.showHeaderContent;
    /**
     * Toggles `Involve People` feature for the Header component.
     * @type {?}
     */
    TaskDetailsComponent.prototype.showInvolvePeople;
    /**
     * Toggles `Comments` feature for the Header component.
     * @type {?}
     */
    TaskDetailsComponent.prototype.showComments;
    /**
     * Toggles `Checklist` feature for the Header component.
     * @type {?}
     */
    TaskDetailsComponent.prototype.showChecklist;
    /**
     * Toggles rendering of the form title.
     * @type {?}
     */
    TaskDetailsComponent.prototype.showFormTitle;
    /**
     * Toggles rendering of the `Complete` outcome button.
     * @type {?}
     */
    TaskDetailsComponent.prototype.showFormCompleteButton;
    /**
     * Toggles rendering of the `Save` outcome button.
     * @type {?}
     */
    TaskDetailsComponent.prototype.showFormSaveButton;
    /**
     * Toggles read-only state of the form. All form widgets render as read-only
     * if enabled.
     * @type {?}
     */
    TaskDetailsComponent.prototype.readOnlyForm;
    /**
     * Toggles rendering of the `Refresh` button.
     * @type {?}
     */
    TaskDetailsComponent.prototype.showFormRefreshButton;
    /**
     * Field validators for use with the form.
     * @type {?}
     */
    TaskDetailsComponent.prototype.fieldValidators;
    /**
     * Emitted when the form is submitted with the `Save` or custom outcomes.
     * @type {?}
     */
    TaskDetailsComponent.prototype.formSaved;
    /**
     * Emitted when the form is submitted with the `Complete` outcome.
     * @type {?}
     */
    TaskDetailsComponent.prototype.formCompleted;
    /**
     * Emitted when the form field content is clicked.
     * @type {?}
     */
    TaskDetailsComponent.prototype.formContentClicked;
    /**
     * Emitted when the form is loaded or reloaded.
     * @type {?}
     */
    TaskDetailsComponent.prototype.formLoaded;
    /**
     * Emitted when a checklist task is created.
     * @type {?}
     */
    TaskDetailsComponent.prototype.taskCreated;
    /**
     * Emitted when a checklist task is deleted.
     * @type {?}
     */
    TaskDetailsComponent.prototype.taskDeleted;
    /**
     * Emitted when an error occurs.
     * @type {?}
     */
    TaskDetailsComponent.prototype.error;
    /**
     * Emitted when any outcome is executed. Default behaviour can be prevented
     * via `event.preventDefault()`.
     * @type {?}
     */
    TaskDetailsComponent.prototype.executeOutcome;
    /**
     * Emitted when a task is assigned.
     * @type {?}
     */
    TaskDetailsComponent.prototype.assignTask;
    /**
     * Emitted when a task is claimed.
     * @type {?}
     */
    TaskDetailsComponent.prototype.claimedTask;
    /**
     * Emitted when a task is unclaimed.
     * @type {?}
     */
    TaskDetailsComponent.prototype.unClaimedTask;
    /** @type {?} */
    TaskDetailsComponent.prototype.taskDetails;
    /** @type {?} */
    TaskDetailsComponent.prototype.taskFormName;
    /** @type {?} */
    TaskDetailsComponent.prototype.taskPeople;
    /** @type {?} */
    TaskDetailsComponent.prototype.noTaskDetailsTemplateComponent;
    /** @type {?} */
    TaskDetailsComponent.prototype.showAssignee;
    /** @type {?} */
    TaskDetailsComponent.prototype.showAttachForm;
    /** @type {?} */
    TaskDetailsComponent.prototype.internalReadOnlyForm;
    /**
     * @type {?}
     * @private
     */
    TaskDetailsComponent.prototype.peopleSearchObserver;
    /** @type {?} */
    TaskDetailsComponent.prototype.errorDialogRef;
    /** @type {?} */
    TaskDetailsComponent.prototype.peopleSearch;
    /** @type {?} */
    TaskDetailsComponent.prototype.currentLoggedUser;
    /** @type {?} */
    TaskDetailsComponent.prototype.data;
    /**
     * @type {?}
     * @private
     */
    TaskDetailsComponent.prototype.taskListService;
    /**
     * @type {?}
     * @private
     */
    TaskDetailsComponent.prototype.authService;
    /**
     * @type {?}
     * @private
     */
    TaskDetailsComponent.prototype.peopleProcessService;
    /**
     * @type {?}
     * @private
     */
    TaskDetailsComponent.prototype.formRenderingService;
    /**
     * @type {?}
     * @private
     */
    TaskDetailsComponent.prototype.logService;
    /**
     * @type {?}
     * @private
     */
    TaskDetailsComponent.prototype.cardViewUpdateService;
    /**
     * @type {?}
     * @private
     */
    TaskDetailsComponent.prototype.dialog;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFzay1kZXRhaWxzLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BhbGZyZXNjby9hZGYtcHJvY2Vzcy1zZXJ2aWNlcy8iLCJzb3VyY2VzIjpbInRhc2stbGlzdC9jb21wb25lbnRzL3Rhc2stZGV0YWlscy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpQkEsT0FBTyxFQUFFLG9CQUFvQixFQUFFLGdCQUFnQixFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDNUUsT0FBTyxFQUNILHFCQUFxQixFQUNyQixxQkFBcUIsRUFFckIsVUFBVSxFQUVWLG9CQUFvQixFQUNwQixpQkFBaUIsRUFDcEIsTUFBTSxvQkFBb0IsQ0FBQztBQUM1QixPQUFPLEVBQ0gsU0FBUyxFQUNULFlBQVksRUFDWixLQUFLLEVBR0wsTUFBTSxFQUVOLFdBQVcsRUFDWCxTQUFTLEVBQ1osTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLFNBQVMsRUFBZ0IsTUFBTSxtQkFBbUIsQ0FBQztBQUM1RCxPQUFPLEVBQUUsVUFBVSxFQUFZLE1BQU0sTUFBTSxDQUFDO0FBRTVDLE9BQU8sRUFBRSxtQ0FBbUMsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzdFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUNqRSxPQUFPLEVBQUUseUJBQXlCLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUU5RixPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFdkM7SUEySUksOEJBQW9CLGVBQWdDLEVBQ2hDLFdBQWtDLEVBQ2xDLG9CQUEwQyxFQUMxQyxvQkFBMEMsRUFDMUMsVUFBc0IsRUFDdEIscUJBQTRDLEVBQzVDLE1BQWlCO1FBTnJDLGlCQWVDO1FBZm1CLG9CQUFlLEdBQWYsZUFBZSxD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QUN4QywyQ0FBMEM7Ozs7O0lBQzFDLG9EQUFrRDs7Ozs7SUFDbEQsb0RBQWtEOzs7OztJQUNsRCwwQ0FBOEI7Ozs7O0lBQzlCLHFEQUFvRDs7Ozs7SUFDcEQsc0NBQXlCIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgQWxmcmVzY28gU29mdHdhcmUsIEx0ZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgUGVvcGxlUHJvY2Vzc1NlcnZpY2UsIFVzZXJQcm9jZXNzTW9kZWwgfSBmcm9tICdAYWxmcmVzY28vYWRmLWNvcmUnO1xuaW1wb3J0IHtcbiAgICBBdXRoZW50aWNhdGlvblNlcnZpY2UsXG4gICAgQ2FyZFZpZXdVcGRhdGVTZXJ2aWNlLFxuICAgIENsaWNrTm90aWZpY2F0aW9uLFxuICAgIExvZ1NlcnZpY2UsXG4gICAgVXBkYXRlTm90aWZpY2F0aW9uLFxuICAgIEZvcm1SZW5kZXJpbmdTZXJ2aWNlLFxuICAgIENvbW1lbnRzQ29tcG9uZW50XG59IGZyb20gJ0BhbGZyZXNjby9hZGYtY29yZSc7XG5pbXBvcnQge1xuICAgIENvbXBvbmVudCxcbiAgICBFdmVudEVtaXR0ZXIsXG4gICAgSW5wdXQsXG4gICAgT25DaGFuZ2VzLFxuICAgIE9uSW5pdCxcbiAgICBPdXRwdXQsXG4gICAgU2ltcGxlQ2hhbmdlcyxcbiAgICBUZW1wbGF0ZVJlZixcbiAgICBWaWV3Q2hpbGRcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBNYXREaWFsb2csIE1hdERpYWxvZ1JlZiB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsJztcbmltcG9ydCB7IE9ic2VydmFibGUsIE9ic2VydmVyIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBDb250ZW50TGlua01vZGVsLCBGb3JtRmllbGRWYWxpZGF0b3IsIEZvcm1Nb2RlbCwgRm9ybU91dGNvbWVFdmVudCB9IGZyb20gJ0BhbGZyZXNjby9hZGYtY29yZSc7XG5pbXBvcnQgeyBUYXNrUXVlcnlSZXF1ZXN0UmVwcmVzZW50YXRpb25Nb2RlbCB9IGZyb20gJy4uL21vZGVscy9maWx0ZXIubW9kZWwnO1xuaW1wb3J0IHsgVGFza0RldGFpbHNNb2RlbCB9IGZyb20gJy4uL21vZGVscy90YXNrLWRldGFpbHMubW9kZWwnO1xuaW1wb3J0IHsgVGFza0xpc3RTZXJ2aWNlIH0gZnJvbSAnLi8uLi9zZXJ2aWNlcy90YXNrbGlzdC5zZXJ2aWNlJztcbmltcG9ydCB7IEF0dGFjaEZpbGVXaWRnZXRDb21wb25lbnQsIEF0dGFjaEZvbGRlcldpZGdldENvbXBvbmVudCB9IGZyb20gJy4uLy4uL2NvbnRlbnQtd2lkZ2V0JztcbmltcG9ydCB7IFVzZXJSZXByZXNlbnRhdGlvbiB9IGZyb20gJ0BhbGZyZXNjby9qcy1hcGknO1xuaW1wb3J0IHsgc2hhcmUgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnYWRmLXRhc2stZGV0YWlscycsXG4gICAgdGVtcGxhdGVVcmw6ICcuL3Rhc2stZGV0YWlscy5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vdGFzay1kZXRhaWxzLmNvbXBvbmVudC5zY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgVGFza0RldGFpbHNDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XG5cbiAgICBAVmlld0NoaWxkKCdhY3Rpdml0aUNvbW1lbnRzJylcbiAgICBhY3Rpdml0aUNvbW1lbnRzOiBDb21tZW50c0NvbXBvbmVudDtcblxuICAgIEBWaWV3Q2hpbGQoJ2FjdGl2aXRpQ2hlY2tsaXN0JylcbiAgICBhY3Rpdml0aUNoZWNrbGlzdDogYW55O1xuXG4gICAgQFZpZXdDaGlsZCgnZXJyb3JEaWFsb2cnKVxuICAgIGVycm9yRGlhbG9nOiBUZW1wbGF0ZVJlZjxhbnk+O1xuXG4gICAgLyoqIFRvZ2dsZXMgZGVidWcgbW9kZS4gKi9cbiAgICBASW5wdXQoKVxuICAgIGRlYnVnTW9kZTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgLyoqICgqKnJlcXVpcmVkKiopIFRoZSBpZCBvZiB0aGUgdGFzayB3aG9zZSBkZXRhaWxzIHdlIGFyZSBhc2tpbmcgZm9yLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgdGFza0lkOiBzdHJpbmc7XG5cbiAgICAvKiogQXV0b21hdGljYWxseSByZW5kZXJzIHRoZSBuZXh0IHRhc2sgd2hlbiB0aGUgY3VycmVudCBvbmUgaXMgY29tcGxldGVkLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2hvd05leHRUYXNrOiBib29sZWFuID0gdHJ1ZTtcblxuICAgIC8qKiBUb2dnbGVzIHRhc2sgZGV0YWlscyBIZWFkZXIgY29tcG9uZW50LiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2hvd0hlYWRlcjogYm9vbGVhbiA9IHRydWU7XG5cbiAgICAvKiogVG9nZ2xlcyBjb2xsYXBzZWQvZXhwYW5kZWQgc3RhdGUgb2YgdGhlIEhlYWRlciBjb21wb25lbnQuICovXG4gICAgQElucHV0KClcbiAgICBzaG93SGVhZGVyQ29udGVudDogYm9vbGVhbiA9IHRydWU7XG5cbiAgICAvKiogVG9nZ2xlcyBgSW52b2x2ZSBQZW9wbGVgIGZlYXR1cmUgZm9yIHRoZSBIZWFkZXIgY29tcG9uZW50LiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2hvd0ludm9sdmVQZW9wbGU6IGJvb2xlYW4gPSB0cnVlO1xuXG4gICAgLyoqIFRvZ2dsZXMgYENvbW1lbnRzYCBmZWF0dXJlIGZvciB0aGUgSGVhZGVyIGNvbXBvbmVudC4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNob3dDb21tZW50czogYm9vbGVhbiA9IHRydWU7XG5cbiAgICAvKiogVG9nZ2xlcyBgQ2hlY2tsaXN0YCBmZWF0dXJlIGZvciB0aGUgSGVhZGVyIGNvbXBvbmVudC4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNob3dDaGVja2xpc3Q6IGJvb2xlYW4gPSB0cnVlO1xuXG4gICAgLyoqIFRvZ2dsZXMgcmVuZGVyaW5nIG9mIHRoZSBmb3JtIHRpdGxlLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2hvd0Zvcm1UaXRsZTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgLyoqIFRvZ2dsZXMgcmVuZGVyaW5nIG9mIHRoZSBgQ29tcGxldGVgIG91dGNvbWUgYnV0dG9uLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2hvd0Zvcm1Db21wbGV0ZUJ1dHRvbjogYm9vbGVhbiA9IHRydWU7XG5cbiAgICAvKiogVG9nZ2xlcyByZW5kZXJpbmcgb2YgdGhlIGBTYXZlYCBvdXRjb21lIGJ1dHRvbi4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNob3dGb3JtU2F2ZUJ1dHRvbjogYm9vbGVhbiA9IHRydWU7XG5cbiAgICAvKiogVG9nZ2xlcyByZWFkLW9ubHkgc3RhdGUgb2YgdGhlIGZvcm0uIEFsbCBmb3JtIHdpZGdldHMgcmVuZGVyIGFzIHJlYWQtb25seVxuICAgICAqIGlmIGVuYWJsZWQuXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICByZWFkT25seUZvcm06IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIC8qKiBUb2dnbGVzIHJlbmRlcmluZyBvZiB0aGUgYFJlZnJlc2hgIGJ1dHRvbi4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNob3dGb3JtUmVmcmVzaEJ1dHRvbjogYm9vbGVhbiA9IHRydWU7XG5cbiAgICAvKiogRmllbGQgdmFsaWRhdG9ycyBmb3IgdXNlIHdpdGggdGhlIGZvcm0uICovXG4gICAgQElucHV0KClcbiAgICBmaWVsZFZhbGlkYXRvcnM6IEZvcm1GaWVsZFZhbGlkYXRvcltdID0gW107XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIHRoZSBmb3JtIGlzIHN1Ym1pdHRlZCB3aXRoIHRoZSBgU2F2ZWAgb3IgY3VzdG9tIG91dGNvbWVzLiAqL1xuICAgIEBPdXRwdXQoKVxuICAgIGZvcm1TYXZlZDogRXZlbnRFbWl0dGVyPEZvcm1Nb2RlbD4gPSBuZXcgRXZlbnRFbWl0dGVyPEZvcm1Nb2RlbD4oKTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gdGhlIGZvcm0gaXMgc3VibWl0dGVkIHdpdGggdGhlIGBDb21wbGV0ZWAgb3V0Y29tZS4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBmb3JtQ29tcGxldGVkOiBFdmVudEVtaXR0ZXI8Rm9ybU1vZGVsPiA9IG5ldyBFdmVudEVtaXR0ZXI8Rm9ybU1vZGVsPigpO1xuXG4gICAgLyoqIEVtaXR0ZWQgd2hlbiB0aGUgZm9ybSBmaWVsZCBjb250ZW50IGlzIGNsaWNrZWQuICovXG4gICAgQE91dHB1dCgpXG4gICAgZm9ybUNvbnRlbnRDbGlja2VkOiBFdmVudEVtaXR0ZXI8Q29udGVudExpbmtNb2RlbD4gPSBuZXcgRXZlbnRFbWl0dGVyPENvbnRlbnRMaW5rTW9kZWw+KCk7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIHRoZSBmb3JtIGlzIGxvYWRlZCBvciByZWxvYWRlZC4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBmb3JtTG9hZGVkOiBFdmVudEVtaXR0ZXI8Rm9ybU1vZGVsPiA9IG5ldyBFdmVudEVtaXR0ZXI8Rm9ybU1vZGVsPigpO1xuXG4gICAgLyoqIEVtaXR0ZWQgd2hlbiBhIGNoZWNrbGlzdCB0YXNrIGlzIGNyZWF0ZWQuICovXG4gICAgQE91dHB1dCgpXG4gICAgdGFza0NyZWF0ZWQ6IEV2ZW50RW1pdHRlcjxUYXNrRGV0YWlsc01vZGVsPiA9IG5ldyBFdmVudEVtaXR0ZXI8VGFza0RldGFpbHNNb2RlbD4oKTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gYSBjaGVja2xpc3QgdGFzayBpcyBkZWxldGVkLiAqL1xuICAgIEBPdXRwdXQoKVxuICAgIHRhc2tEZWxldGVkOiBFdmVudEVtaXR0ZXI8c3RyaW5nPiA9IG5ldyBFdmVudEVtaXR0ZXI8c3RyaW5nPigpO1xuXG4gICAgLyoqIEVtaXR0ZWQgd2hlbiBhbiBlcnJvciBvY2N1cnMuICovXG4gICAgQE91dHB1dCgpXG4gICAgZXJyb3I6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIGFueSBvdXRjb21lIGlzIGV4ZWN1dGVkLiBEZWZhdWx0IGJlaGF2aW91ciBjYW4gYmUgcHJldmVudGVkXG4gICAgICogdmlhIGBldmVudC5wcmV2ZW50RGVmYXVsdCgpYC5cbiAgICAgKi9cbiAgICBAT3V0cHV0KClcbiAgICBleGVjdXRlT3V0Y29tZTogRXZlbnRFbWl0dGVyPEZvcm1PdXRjb21lRXZlbnQ+ID0gbmV3IEV2ZW50RW1pdHRlcjxGb3JtT3V0Y29tZUV2ZW50PigpO1xuXG4gICAgLyoqIEVtaXR0ZWQgd2hlbiBhIHRhc2sgaXMgYXNzaWduZWQuICovXG4gICAgQE91dHB1dCgpXG4gICAgYXNzaWduVGFzazogRXZlbnRFbWl0dGVyPHZvaWQ+ID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuXG4gICAgLyoqIEVtaXR0ZWQgd2hlbiBhIHRhc2sgaXMgY2xhaW1lZC4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBjbGFpbWVkVGFzazogRXZlbnRFbWl0dGVyPHN0cmluZz4gPSBuZXcgRXZlbnRFbWl0dGVyPHN0cmluZz4oKTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gYSB0YXNrIGlzIHVuY2xhaW1lZC4gKi9cbiAgICBAT3V0cHV0KClcbiAgICB1bkNsYWltZWRUYXNrOiBFdmVudEVtaXR0ZXI8c3RyaW5nPiA9IG5ldyBFdmVudEVtaXR0ZXI8c3RyaW5nPigpO1xuXG4gICAgdGFza0RldGFpbHM6IFRhc2tEZXRhaWxzTW9kZWw7XG4gICAgdGFza0Zvcm1OYW1lOiBzdHJpbmcgPSBudWxsO1xuXG4gICAgdGFza1Blb3BsZTogVXNlclByb2Nlc3NNb2RlbFtdID0gW107XG5cbiAgICBub1Rhc2tEZXRhaWxzVGVtcGxhdGVDb21wb25lbnQ6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgICBzaG93QXNzaWduZWU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBzaG93QXR0YWNoRm9ybTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIGludGVybmFsUmVhZE9ubHlGb3JtOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBwcml2YXRlIHBlb3BsZVNlYXJjaE9ic2VydmVyOiBPYnNlcnZlcjxVc2VyUHJvY2Vzc01vZGVsW10+O1xuICAgIHB1YmxpYyBlcnJvckRpYWxvZ1JlZjogTWF0RGlhbG9nUmVmPFRlbXBsYXRlUmVmPGFueT4+O1xuXG4gICAgcGVvcGxlU2VhcmNoOiBPYnNlcnZhYmxlPFVzZXJQcm9jZXNzTW9kZWxbXT47XG5cbiAgICBjdXJyZW50TG9nZ2VkVXNlcjogVXNlclJlcHJlc2VudGF0aW9uO1xuICAgIGRhdGE6IGFueTtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdGFza0xpc3RTZXJ2aWNlOiBUYXNrTGlzdFNlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBhdXRoU2VydmljZTogQXV0aGVudGljYXRpb25TZXJ2aWNlLFxuICAgICAgICAgICAgICAgIHByaXZhdGUgcGVvcGxlUHJvY2Vzc1NlcnZpY2U6IFBlb3BsZVByb2Nlc3NTZXJ2aWNlLFxuICAgICAgICAgICAgICAgIHByaXZhdGUgZm9ybVJlbmRlcmluZ1NlcnZpY2U6IEZvcm1SZW5kZXJpbmdTZXJ2aWNlLFxuICAgICAgICAgICAgICAgIHByaXZhdGUgbG9nU2VydmljZTogTG9nU2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIGNhcmRWaWV3VXBkYXRlU2VydmljZTogQ2FyZFZpZXdVcGRhdGVTZXJ2aWNlLFxuICAgICAgICAgICAgICAgIHByaXZhdGUgZGlhbG9nOiBNYXREaWFsb2cpIHtcblxuICAgICAgICB0aGlzLmZvcm1SZW5kZXJpbmdTZXJ2aWNlLnNldENvbXBvbmVudFR5cGVSZXNvbHZlcignc2VsZWN0LWZvbGRlcicsICgpID0+IEF0dGFjaEZvbGRlcldpZGdldENvbXBvbmVudCwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuZm9ybVJlbmRlcmluZ1NlcnZpY2Uuc2V0Q29tcG9uZW50VHlwZVJlc29sdmVyKCd1cGxvYWQnLCAoKSA9PiBBdHRhY2hGaWxlV2lkZ2V0Q29tcG9uZW50LCB0cnVlKTtcbiAgICAgICAgdGhpcy5wZW9wbGVTZWFyY2ggPSBuZXcgT2JzZXJ2YWJsZTxVc2VyUHJvY2Vzc01vZGVsW10+KChvYnNlcnZlcikgPT4gdGhpcy5wZW9wbGVTZWFyY2hPYnNlcnZlciA9IG9ic2VydmVyKVxuICAgICAgICAgICAgLnBpcGUoc2hhcmUoKSk7XG4gICAgICAgIHRoaXMuYXV0aFNlcnZpY2UuZ2V0QnBtTG9nZ2VkVXNlcigpLnN1YnNjcmliZSgodXNlcjogVXNlclJlcHJlc2VudGF0aW9uKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRMb2dnZWRVc2VyID0gdXNlcjtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIGlmICh0aGlzLnRhc2tJZCkge1xuICAgICAgICAgICAgdGhpcy5sb2FkRGV0YWlscyh0aGlzLnRhc2tJZCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNhcmRWaWV3VXBkYXRlU2VydmljZS5pdGVtVXBkYXRlZCQuc3Vic2NyaWJlKHRoaXMudXBkYXRlVGFza0RldGFpbHMuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuY2FyZFZpZXdVcGRhdGVTZXJ2aWNlLml0ZW1DbGlja2VkJC5zdWJzY3JpYmUodGhpcy5jbGlja1Rhc2tEZXRhaWxzLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICAgICAgbGV0IHRhc2tJZCA9IGNoYW5nZXMudGFza0lkO1xuICAgICAgICB0aGlzLnNob3dBc3NpZ25lZSA9IGZhbHNlO1xuXG4gICAgICAgIGlmICh0YXNrSWQgJiYgIXRhc2tJZC5jdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0YXNrSWQgJiYgdGFza0lkLmN1cnJlbnRWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5sb2FkRGV0YWlscyh0YXNrSWQuY3VycmVudFZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlzU3RhbmRhbG9uZVRhc2soKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAhKHRoaXMudGFza0RldGFpbHMgJiYgKCEhdGhpcy50YXNrRGV0YWlscy5wcm9jZXNzRGVmaW5pdGlvbklkKSk7XG4gICAgfVxuXG4gICAgaXNTdGFuZGFsb25lVGFza1dpdGhGb3JtKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5pc1N0YW5kYWxvbmVUYXNrKCkgJiYgdGhpcy5oYXNGb3JtS2V5KCk7XG4gICAgfVxuXG4gICAgaXNTdGFuZGFsb25lVGFza1dpdGhvdXRGb3JtKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5pc1N0YW5kYWxvbmVUYXNrKCkgJiYgIXRoaXMuaGFzRm9ybUtleSgpO1xuICAgIH1cblxuICAgIGlzRm9ybUNvbXBvbmVudFZpc2libGUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc0Zvcm1LZXkoKSAmJiAhdGhpcy5pc1Nob3dBdHRhY2hGb3JtKCk7XG4gICAgfVxuXG4gICAgaXNUYXNrU3RhbmRhbG9uZUNvbXBvbmVudFZpc2libGUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzU3RhbmRhbG9uZVRhc2tXaXRob3V0Rm9ybSgpICYmICF0aGlzLmlzU2hvd0F0dGFjaEZvcm0oKTtcbiAgICB9XG5cbiAgICBpc1Nob3dBdHRhY2hGb3JtKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5zaG93QXR0YWNoRm9ybTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNldCB0aGUgdGFzayBkZXRhaWxzXG4gICAgICovXG4gICAgcHJpdmF0ZSByZXNldCgpIHtcbiAgICAgICAgdGhpcy50YXNrRGV0YWlscyA9IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgdGhlIHRhc2sgaGFzIGEgZm9ybVxuICAgICAqL1xuICAgIGhhc0Zvcm1LZXkoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAodGhpcy50YXNrRGV0YWlscyAmJiAoISF0aGlzLnRhc2tEZXRhaWxzLmZvcm1LZXkpKTtcbiAgICB9XG5cbiAgICBpc1Rhc2tBY3RpdmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRhc2tEZXRhaWxzICYmIHRoaXMudGFza0RldGFpbHMuZHVyYXRpb24gPT09IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2F2ZSBhIHRhc2sgZGV0YWlsIGFuZCB1cGRhdGUgaXQgYWZ0ZXIgYSBzdWNjZXNzZnVsIHJlc3BvbnNlXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdXBkYXRlTm90aWZpY2F0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSB1cGRhdGVUYXNrRGV0YWlscyh1cGRhdGVOb3RpZmljYXRpb246IFVwZGF0ZU5vdGlmaWNhdGlvbikge1xuICAgICAgICB0aGlzLnRhc2tMaXN0U2VydmljZS51cGRhdGVUYXNrKHRoaXMudGFza0lkLCB1cGRhdGVOb3RpZmljYXRpb24uY2hhbmdlZClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWREZXRhaWxzKHRoaXMudGFza0lkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgY2xpY2tUYXNrRGV0YWlscyhjbGlja05vdGlmaWNhdGlvbjogQ2xpY2tOb3RpZmljYXRpb24pIHtcbiAgICAgICAgaWYgKGNsaWNrTm90aWZpY2F0aW9uLnRhcmdldC5rZXkgPT09ICdhc3NpZ25lZScpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0Fzc2lnbmVlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2xpY2tOb3RpZmljYXRpb24udGFyZ2V0LmtleSA9PT0gJ2Zvcm1OYW1lJykge1xuICAgICAgICAgICAgdGhpcy5zaG93QXR0YWNoRm9ybSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkIHRoZSBhY3Rpdml0aSB0YXNrIGRldGFpbHNcbiAgICAgKiBAcGFyYW0gdGFza0lkXG4gICAgICovXG4gICAgcHJpdmF0ZSBsb2FkRGV0YWlscyh0YXNrSWQ6IHN0cmluZykge1xuICAgICAgICB0aGlzLnRhc2tQZW9wbGUgPSBbXTtcbiAgICAgICAgdGhpcy50YXNrRm9ybU5hbWUgPSBudWxsO1xuXG4gICAgICAgIGlmICh0YXNrSWQpIHtcbiAgICAgICAgICAgIHRoaXMudGFza0xpc3RTZXJ2aWNlLmdldFRhc2tEZXRhaWxzKHRhc2tJZCkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgICAgIChyZXM6IFRhc2tEZXRhaWxzTW9kZWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93QXR0YWNoRm9ybSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRhc2tEZXRhaWxzID0gcmVzO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRhc2tEZXRhaWxzLm5hbWUgPT09ICdudWxsJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YXNrRGV0YWlscy5uYW1lID0gJ05vIG5hbWUnO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGVuZERhdGU6IGFueSA9IHJlcy5lbmREYXRlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW5kRGF0ZSAmJiAhaXNOYU4oZW5kRGF0ZS5nZXRUaW1lKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludGVybmFsUmVhZE9ubHlGb3JtID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW50ZXJuYWxSZWFkT25seUZvcm0gPSB0aGlzLnJlYWRPbmx5Rm9ybTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRhc2tEZXRhaWxzICYmIHRoaXMudGFza0RldGFpbHMuaW52b2x2ZWRQZW9wbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFza0RldGFpbHMuaW52b2x2ZWRQZW9wbGUuZm9yRWFjaCgodXNlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFza1Blb3BsZS5wdXNoKG5ldyBVc2VyUHJvY2Vzc01vZGVsKHVzZXIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpc0Fzc2lnbmVkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gISF0aGlzLnRhc2tEZXRhaWxzLmFzc2lnbmVlO1xuICAgIH1cblxuICAgIHByaXZhdGUgaGFzRW1haWxBZGRyZXNzKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy50YXNrRGV0YWlscy5hc3NpZ25lZS5lbWFpbCA/IHRydWUgOiBmYWxzZTtcbiAgICB9XG5cbiAgICBpc0Fzc2lnbmVkVG9NZSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNBc3NpZ25lZCgpICYmIHRoaXMuaGFzRW1haWxBZGRyZXNzKCkgP1xuICAgICAgICAgICAgdGhpcy5pc0VtYWlsRXF1YWwodGhpcy50YXNrRGV0YWlscy5hc3NpZ25lZS5lbWFpbCwgdGhpcy5jdXJyZW50TG9nZ2VkVXNlci5lbWFpbCkgOlxuICAgICAgICAgICAgdGhpcy5pc0V4dGVybmFsSWRFcXVhbCh0aGlzLnRhc2tEZXRhaWxzLmFzc2lnbmVlLmV4dGVybmFsSWQsIHRoaXMuY3VycmVudExvZ2dlZFVzZXIuZXh0ZXJuYWxJZCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc0VtYWlsRXF1YWwoYXNzaWduZWVNYWlsLCBjdXJyZW50TG9nZ2VkRW1haWwpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIGFzc2lnbmVlTWFpbC50b0xvY2FsZUxvd2VyQ2FzZSgpID09PSBjdXJyZW50TG9nZ2VkRW1haWwudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGlzRXh0ZXJuYWxJZEVxdWFsKGFzc2lnbmVlRXh0ZXJuYWxJZCwgY3VycmVudFVzZXJFeHRlcm5hbElkKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBhc3NpZ25lZUV4dGVybmFsSWQudG9Mb2NhbGVMb3dlckNhc2UoKSA9PT0gY3VycmVudFVzZXJFeHRlcm5hbElkLnRvTG9jYWxlTG93ZXJDYXNlKCk7XG4gICAgfVxuXG4gICAgaXNDb21wbGV0ZUJ1dHRvbkVuYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzQXNzaWduZWRUb01lKCkgfHwgdGhpcy5jYW5Jbml0aWF0b3JDb21wbGV0ZSgpO1xuICAgIH1cblxuICAgIGlzQ29tcGxldGVCdXR0b25WaXNpYmxlKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gIXRoaXMuaGFzRm9ybUtleSgpICYmIHRoaXMuaXNUYXNrQWN0aXZlKCkgJiYgdGhpcy5pc0NvbXBsZXRlQnV0dG9uRW5hYmxlZCgpO1xuICAgIH1cblxuICAgIGNhbkluaXRpYXRvckNvbXBsZXRlKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy50YXNrRGV0YWlscy5pbml0aWF0b3JDYW5Db21wbGV0ZVRhc2s7XG4gICAgfVxuXG4gICAgaXNTYXZlQnV0dG9uVmlzaWJsZSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzU2F2ZUJ1dHRvbigpICYmICghdGhpcy5jYW5Jbml0aWF0b3JDb21wbGV0ZSgpIHx8IHRoaXMuaXNBc3NpZ25lZFRvTWUoKSk7XG4gICAgfVxuXG4gICAgaGFzU2F2ZUJ1dHRvbigpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2hvd0Zvcm1TYXZlQnV0dG9uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIHRoZSBuZXh0IG9wZW4gdGFza1xuICAgICAqIEBwYXJhbSBwcm9jZXNzSW5zdGFuY2VJZFxuICAgICAqIEBwYXJhbSBwcm9jZXNzRGVmaW5pdGlvbklkXG4gICAgICovXG4gICAgcHJpdmF0ZSBsb2FkTmV4dFRhc2socHJvY2Vzc0luc3RhbmNlSWQ6IHN0cmluZywgcHJvY2Vzc0RlZmluaXRpb25JZDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGxldCByZXF1ZXN0Tm9kZSA9IG5ldyBUYXNrUXVlcnlSZXF1ZXN0UmVwcmVzZW50YXRpb25Nb2RlbChcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcm9jZXNzSW5zdGFuY2VJZDogcHJvY2Vzc0luc3RhbmNlSWQsXG4gICAgICAgICAgICAgICAgcHJvY2Vzc0RlZmluaXRpb25JZDogcHJvY2Vzc0RlZmluaXRpb25JZFxuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICB0aGlzLnRhc2tMaXN0U2VydmljZS5nZXRUYXNrcyhyZXF1ZXN0Tm9kZSkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXNrRGV0YWlscyA9IG5ldyBUYXNrRGV0YWlsc01vZGVsKHJlc3BvbnNlWzBdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvci5lbWl0KGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbXBsZXRlIGJ1dHRvbiBjbGlja2VkXG4gICAgICovXG4gICAgb25Db21wbGV0ZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50YXNrTGlzdFNlcnZpY2UuY29tcGxldGVUYXNrKHRoaXMudGFza0lkKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICAocmVzKSA9PiB0aGlzLm9uRm9ybUNvbXBsZXRlZChudWxsKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIG9uU2hvd0F0dGFjaEZvcm0oKSB7XG4gICAgICAgIHRoaXMuc2hvd0F0dGFjaEZvcm0gPSB0cnVlO1xuICAgIH1cblxuICAgIG9uQ2FuY2VsQXR0YWNoRm9ybSgpIHtcbiAgICAgICAgdGhpcy5zaG93QXR0YWNoRm9ybSA9IGZhbHNlO1xuICAgIH1cblxuICAgIG9uQ29tcGxldGVBdHRhY2hGb3JtKCkge1xuICAgICAgICB0aGlzLnNob3dBdHRhY2hGb3JtID0gZmFsc2U7XG4gICAgICAgIHRoaXMubG9hZERldGFpbHModGhpcy50YXNrSWQpO1xuICAgIH1cblxuICAgIG9uRm9ybUNvbnRlbnRDbGljayhjb250ZW50OiBDb250ZW50TGlua01vZGVsKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZm9ybUNvbnRlbnRDbGlja2VkLmVtaXQoY29udGVudCk7XG4gICAgfVxuXG4gICAgb25Gb3JtU2F2ZWQoZm9ybTogRm9ybU1vZGVsKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZm9ybVNhdmVkLmVtaXQoZm9ybSk7XG4gICAgfVxuXG4gICAgb25Gb3JtQ29tcGxldGVkKGZvcm06IEZvcm1Nb2RlbCk6IHZvaWQge1xuICAgICAgICB0aGlzLmZvcm1Db21wbGV0ZWQuZW1pdChmb3JtKTtcbiAgICAgICAgaWYgKHRoaXMuc2hvd05leHRUYXNrICYmICh0aGlzLnRhc2tEZXRhaWxzLnByb2Nlc3NJbnN0YW5jZUlkIHx8IHRoaXMudGFza0RldGFpbHMucHJvY2Vzc0RlZmluaXRpb25JZCkpIHtcbiAgICAgICAgICAgIHRoaXMubG9hZE5leHRUYXNrKHRoaXMudGFza0RldGFpbHMucHJvY2Vzc0luc3RhbmNlSWQsIHRoaXMudGFza0RldGFpbHMucHJvY2Vzc0RlZmluaXRpb25JZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkZvcm1Mb2FkZWQoZm9ybTogRm9ybU1vZGVsKTogdm9pZCB7XG4gICAgICAgIHRoaXMudGFza0Zvcm1OYW1lID0gKGZvcm0gJiYgZm9ybS5uYW1lID8gZm9ybS5uYW1lIDogbnVsbCk7XG4gICAgICAgIHRoaXMuZm9ybUxvYWRlZC5lbWl0KGZvcm0pO1xuICAgIH1cblxuICAgIG9uQ2hlY2tsaXN0VGFza0NyZWF0ZWQodGFzazogVGFza0RldGFpbHNNb2RlbCk6IHZvaWQge1xuICAgICAgICB0aGlzLnRhc2tDcmVhdGVkLmVtaXQodGFzayk7XG4gICAgfVxuXG4gICAgb25DaGVja2xpc3RUYXNrRGVsZXRlZCh0YXNrSWQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLnRhc2tEZWxldGVkLmVtaXQodGFza0lkKTtcbiAgICB9XG5cbiAgICBvbkZvcm1FcnJvcihlcnJvcjogYW55KTogdm9pZCB7XG4gICAgICAgIHRoaXMuZXJyb3JEaWFsb2dSZWYgPSB0aGlzLmRpYWxvZy5vcGVuKHRoaXMuZXJyb3JEaWFsb2csIHsgd2lkdGg6ICc1MDBweCcgfSk7XG4gICAgICAgIHRoaXMuZXJyb3IuZW1pdChlcnJvcik7XG4gICAgfVxuXG4gICAgb25Gb3JtRXhlY3V0ZU91dGNvbWUoZXZlbnQ6IEZvcm1PdXRjb21lRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5leGVjdXRlT3V0Y29tZS5lbWl0KGV2ZW50KTtcbiAgICB9XG5cbiAgICBjbG9zZUVycm9yRGlhbG9nKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmRpYWxvZy5jbG9zZUFsbCgpO1xuICAgIH1cblxuICAgIG9uQ2xhaW1BY3Rpb24odGFza0lkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jbGFpbWVkVGFzay5lbWl0KHRhc2tJZCk7XG4gICAgICAgIHRoaXMubG9hZERldGFpbHModGFza0lkKTtcbiAgICB9XG5cbiAgICBvblVuY2xhaW1BY3Rpb24odGFza0lkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy51bkNsYWltZWRUYXNrLmVtaXQodGFza0lkKTtcbiAgICAgICAgdGhpcy5sb2FkRGV0YWlscyh0YXNrSWQpO1xuICAgIH1cblxuICAgIGlzQ29tcGxldGVkVGFzaygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGFza0RldGFpbHMgJiYgdGhpcy50YXNrRGV0YWlscy5lbmREYXRlID8gdHJ1ZSA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBzZWFyY2hVc2VyKHNlYXJjaGVkV29yZDogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMucGVvcGxlUHJvY2Vzc1NlcnZpY2UuZ2V0V29ya2Zsb3dVc2VycyhudWxsLCBzZWFyY2hlZFdvcmQpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKCh1c2VycykgPT4ge1xuICAgICAgICAgICAgICAgIHVzZXJzID0gdXNlcnMuZmlsdGVyKCh1c2VyKSA9PiB1c2VyLmlkICE9PSB0aGlzLnRhc2tEZXRhaWxzLmFzc2lnbmVlLmlkKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBlb3BsZVNlYXJjaE9ic2VydmVyLm5leHQodXNlcnMpO1xuICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB0aGlzLmxvZ1NlcnZpY2UuZXJyb3IoJ0NvdWxkIG5vdCBsb2FkIHVzZXJzJykpO1xuICAgIH1cblxuICAgIG9uQ2xvc2VTZWFyY2goKSB7XG4gICAgICAgIHRoaXMuc2hvd0Fzc2lnbmVlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgYXNzaWduVGFza1RvVXNlcihzZWxlY3RlZFVzZXI6IFVzZXJQcm9jZXNzTW9kZWwpIHtcbiAgICAgICAgdGhpcy50YXNrTGlzdFNlcnZpY2UuYXNzaWduVGFzayh0aGlzLnRhc2tEZXRhaWxzLmlkLCBzZWxlY3RlZFVzZXIpLnN1YnNjcmliZShcbiAgICAgICAgICAgIChyZXM6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nU2VydmljZS5pbmZvKCdUYXNrIEFzc2lnbmVkIHRvICcgKyBzZWxlY3RlZFVzZXIuZW1haWwpO1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzaWduVGFzay5lbWl0KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zaG93QXNzaWduZWUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBnZXRUYXNrSGVhZGVyVmlld0NsYXNzKCk6IHN0cmluZyB7XG4gICAgICAgIGlmICh0aGlzLnNob3dBc3NpZ25lZSkge1xuICAgICAgICAgICAgcmV0dXJuICdhc3NpZ24tZWRpdC12aWV3JztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAnZGVmYXVsdC12aWV3JztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlzUmVhZE9ubHlDb21tZW50KCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gKHRoaXMudGFza0RldGFpbHMgJiYgdGhpcy50YXNrRGV0YWlscy5pc0NvbXBsZXRlZCgpKSAmJiAodGhpcy50YXNrUGVvcGxlICYmIHRoaXMudGFza1Blb3BsZS5sZW5ndGggPT09IDApO1xuICAgIH1cbn1cbiJdfQ==