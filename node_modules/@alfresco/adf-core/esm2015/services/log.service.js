/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/* tslint:disable:no-console  */
import { Injectable } from '@angular/core';
import { AppConfigService, AppConfigValues } from '../app-config/app-config.service';
import { logLevels, LogLevelsEnum } from '../models/log-levels.model';
import { Subject } from 'rxjs';
import * as i0 from "@angular/core";
import * as i1 from "../app-config/app-config.service";
export class LogService {
    /**
     * @param {?} appConfig
     */
    constructor(appConfig) {
        this.appConfig = appConfig;
        this.onMessage = new Subject();
    }
    /**
     * @return {?}
     */
    get currentLogLevel() {
        /** @type {?} */
        let configLevel = this.appConfig.get(AppConfigValues.LOG_LEVEL);
        if (configLevel) {
            return this.getLogLevel(configLevel);
        }
        return LogLevelsEnum.TRACE;
    }
    /**
     * Logs a message at the "ERROR" level.
     * @param {?=} message Message to log
     * @param {...?} optionalParams Interpolation values for the message in "printf" format
     * @return {?}
     */
    error(message, ...optionalParams) {
        if (this.currentLogLevel >= LogLevelsEnum.ERROR) {
            this.messageBus(message, 'ERROR');
            console.error(message, ...optionalParams);
        }
    }
    /**
     * Logs a message at the "DEBUG" level.
     * @param {?=} message Message to log
     * @param {...?} optionalParams Interpolation values for the message in "printf" format
     * @return {?}
     */
    debug(message, ...optionalParams) {
        if (this.currentLogLevel >= LogLevelsEnum.DEBUG) {
            this.messageBus(message, 'DEBUG');
            console.debug(message, ...optionalParams);
        }
    }
    /**
     * Logs a message at the "INFO" level.
     * @param {?=} message Message to log
     * @param {...?} optionalParams Interpolation values for the message in "printf" format
     * @return {?}
     */
    info(message, ...optionalParams) {
        if (this.currentLogLevel >= LogLevelsEnum.INFO) {
            this.messageBus(message, 'INFO');
            console.info(message, ...optionalParams);
        }
    }
    /**
     * Logs a message at any level from "TRACE" upwards.
     * @param {?=} message Message to log
     * @param {...?} optionalParams Interpolation values for the message in "printf" format
     * @return {?}
     */
    log(message, ...optionalParams) {
        if (this.currentLogLevel >= LogLevelsEnum.TRACE) {
            this.messageBus(message, 'LOG');
            console.log(message, ...optionalParams);
        }
    }
    /**
     * Logs a message at the "TRACE" level.
     * @param {?=} message Message to log
     * @param {...?} optionalParams Interpolation values for the message in "printf" format
     * @return {?}
     */
    trace(message, ...optionalParams) {
        if (this.currentLogLevel >= LogLevelsEnum.TRACE) {
            this.messageBus(message, 'TRACE');
            console.trace(message, ...optionalParams);
        }
    }
    /**
     * Logs a message at the "WARN" level.
     * @param {?=} message Message to log
     * @param {...?} optionalParams Interpolation values for the message in "printf" format
     * @return {?}
     */
    warn(message, ...optionalParams) {
        if (this.currentLogLevel >= LogLevelsEnum.WARN) {
            this.messageBus(message, 'WARN');
            console.warn(message, ...optionalParams);
        }
    }
    /**
     * Logs a message if a boolean test fails.
     * @param {?=} test Test value (typically a boolean expression)
     * @param {?=} message Message to show if test is false
     * @param {...?} optionalParams Interpolation values for the message in "printf" format
     * @return {?}
     */
    assert(test, message, ...optionalParams) {
        if (this.currentLogLevel !== LogLevelsEnum.SILENT) {
            this.messageBus(message, 'ASSERT');
            console.assert(test, message, ...optionalParams);
        }
    }
    /**
     * Starts an indented group of log messages.
     * @param {?=} groupTitle Title shown at the start of the group
     * @param {...?} optionalParams Interpolation values for the title in "printf" format
     * @return {?}
     */
    group(groupTitle, ...optionalParams) {
        if (this.currentLogLevel !== LogLevelsEnum.SILENT) {
            console.group(groupTitle, ...optionalParams);
        }
    }
    /**
     * Ends a indented group of log messages.
     * @return {?}
     */
    groupEnd() {
        if (this.currentLogLevel !== LogLevelsEnum.SILENT) {
            console.groupEnd();
        }
    }
    /**
     * Converts a log level name string into its numeric equivalent.
     * @param {?} level Level name
     * @return {?} Numeric log level
     */
    getLogLevel(level) {
        /** @type {?} */
        let referencedLevel = logLevels.find((currentLevel) => {
            return currentLevel.name.toLocaleLowerCase() === level.toLocaleLowerCase();
        });
        return referencedLevel ? referencedLevel.level : 5;
    }
    /**
     * Triggers notification callback for log messages.
     * @param {?} text Message text
     * @param {?} logLevel Log level for the message
     * @return {?}
     */
    messageBus(text, logLevel) {
        this.onMessage.next({ text: text, type: logLevel });
    }
}
LogService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
/** @nocollapse */
LogService.ctorParameters = () => [
    { type: AppConfigService }
];
/** @nocollapse */ LogService.ngInjectableDef = i0.defineInjectable({ factory: function LogService_Factory() { return new LogService(i0.inject(i1.AppConfigService)); }, token: LogService, providedIn: "root" });
if (false) {
    /** @type {?} */
    LogService.prototype.onMessage;
    /**
     * @type {?}
     * @private
     */
    LogService.prototype.appConfig;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYWxmcmVzY28vYWRmLWNvcmUvIiwic291cmNlcyI6WyJzZXJ2aWNlcy9sb2cuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFtQkEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsZUFBZSxFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDckYsT0FBTyxFQUFFLFNBQVMsRUFBRSxhQUFhLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUN0RSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDOzs7QUFLL0IsTUFBTSxPQUFPLFVBQVU7Ozs7SUFjbkIsWUFBb0IsU0FBMkI7UUFBM0IsY0FBUyxHQUFULFNBQVMsQ0FBa0I7UUFDM0MsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLE9BQU8sRUFBRSxDQUFDO0lBQ25DLENBQUM7Ozs7SUFkRCxJQUFJLGVBQWU7O1lBQ1gsV0FBVyxHQUFXLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFTLGVBQWUsQ0FBQyxTQUFTLENBQUM7UUFFL0UsSUFBSSxXQUFXLEVBQUU7WUFDYixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDeEM7UUFFRCxPQUFPLGFBQWEsQ0FBQyxLQUFLLENBQUM7SUFDL0IsQ0FBQzs7Ozs7OztJQWFELEtBQUssQ0FBQyxPQUFhLEVBQUUsR0FBRyxjQUFxQjtRQUN6QyxJQUFJLElBQUksQ0FBQyxlQUFlLElBQUksYUFBYSxDQUFDLEtBQUssRUFBRTtZQUU3QyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztZQUVsQyxPQUFPLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxHQUFHLGNBQWMsQ0FBQyxDQUFDO1NBQzdDO0lBQ0wsQ0FBQzs7Ozs7OztJQU9E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QUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN2RCxDQUFDOzs7Ozs7O0lBT0QsVUFBVSxDQUFDLElBQVksRUFBRSxRQUFnQjtRQUNyQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUM7SUFDeEQsQ0FBQzs7O1lBaEtKLFVBQVUsU0FBQztnQkFDUixVQUFVLEVBQUUsTUFBTTthQUNyQjs7OztZQU5RLGdCQUFnQjs7Ozs7SUFtQnJCLCtCQUF3Qjs7Ozs7SUFFWiwrQkFBbUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBBbGZyZXNjbyBTb2Z0d2FyZSwgTHRkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKiB0c2xpbnQ6ZGlzYWJsZTpuby1jb25zb2xlICAqL1xuXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBBcHBDb25maWdTZXJ2aWNlLCBBcHBDb25maWdWYWx1ZXMgfSBmcm9tICcuLi9hcHAtY29uZmlnL2FwcC1jb25maWcuc2VydmljZSc7XG5pbXBvcnQgeyBsb2dMZXZlbHMsIExvZ0xldmVsc0VudW0gfSBmcm9tICcuLi9tb2RlbHMvbG9nLWxldmVscy5tb2RlbCc7XG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5cbkBJbmplY3RhYmxlKHtcbiAgICBwcm92aWRlZEluOiAncm9vdCdcbn0pXG5leHBvcnQgY2xhc3MgTG9nU2VydmljZSB7XG5cbiAgICBnZXQgY3VycmVudExvZ0xldmVsKCkge1xuICAgICAgICBsZXQgY29uZmlnTGV2ZWw6IHN0cmluZyA9IHRoaXMuYXBwQ29uZmlnLmdldDxzdHJpbmc+KEFwcENvbmZpZ1ZhbHVlcy5MT0dfTEVWRUwpO1xuXG4gICAgICAgIGlmIChjb25maWdMZXZlbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TG9nTGV2ZWwoY29uZmlnTGV2ZWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIExvZ0xldmVsc0VudW0uVFJBQ0U7XG4gICAgfVxuXG4gICAgb25NZXNzYWdlOiBTdWJqZWN0PGFueT47XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcENvbmZpZzogQXBwQ29uZmlnU2VydmljZSkge1xuICAgICAgICB0aGlzLm9uTWVzc2FnZSA9IG5ldyBTdWJqZWN0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9ncyBhIG1lc3NhZ2UgYXQgdGhlIFwiRVJST1JcIiBsZXZlbC5cbiAgICAgKiBAcGFyYW0gbWVzc2FnZSBNZXNzYWdlIHRvIGxvZ1xuICAgICAqIEBwYXJhbSBvcHRpb25hbFBhcmFtcyBJbnRlcnBvbGF0aW9uIHZhbHVlcyBmb3IgdGhlIG1lc3NhZ2UgaW4gXCJwcmludGZcIiBmb3JtYXRcbiAgICAgKi9cbiAgICBlcnJvcihtZXNzYWdlPzogYW55LCAuLi5vcHRpb25hbFBhcmFtczogYW55W10pIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExvZ0xldmVsID49IExvZ0xldmVsc0VudW0uRVJST1IpIHtcblxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzKG1lc3NhZ2UsICdFUlJPUicpO1xuXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKG1lc3NhZ2UsIC4uLm9wdGlvbmFsUGFyYW1zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvZ3MgYSBtZXNzYWdlIGF0IHRoZSBcIkRFQlVHXCIgbGV2ZWwuXG4gICAgICogQHBhcmFtIG1lc3NhZ2UgTWVzc2FnZSB0byBsb2dcbiAgICAgKiBAcGFyYW0gb3B0aW9uYWxQYXJhbXMgSW50ZXJwb2xhdGlvbiB2YWx1ZXMgZm9yIHRoZSBtZXNzYWdlIGluIFwicHJpbnRmXCIgZm9ybWF0XG4gICAgICovXG4gICAgZGVidWcobWVzc2FnZT86IGFueSwgLi4ub3B0aW9uYWxQYXJhbXM6IGFueVtdKSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRMb2dMZXZlbCA+PSBMb2dMZXZlbHNFbnVtLkRFQlVHKSB7XG5cbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cyhtZXNzYWdlLCAnREVCVUcnKTtcblxuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhtZXNzYWdlLCAuLi5vcHRpb25hbFBhcmFtcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2dzIGEgbWVzc2FnZSBhdCB0aGUgXCJJTkZPXCIgbGV2ZWwuXG4gICAgICogQHBhcmFtIG1lc3NhZ2UgTWVzc2FnZSB0byBsb2dcbiAgICAgKiBAcGFyYW0gb3B0aW9uYWxQYXJhbXMgSW50ZXJwb2xhdGlvbiB2YWx1ZXMgZm9yIHRoZSBtZXNzYWdlIGluIFwicHJpbnRmXCIgZm9ybWF0XG4gICAgICovXG4gICAgaW5mbyhtZXNzYWdlPzogYW55LCAuLi5vcHRpb25hbFBhcmFtczogYW55W10pIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExvZ0xldmVsID49IExvZ0xldmVsc0VudW0uSU5GTykge1xuXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMobWVzc2FnZSwgJ0lORk8nKTtcblxuICAgICAgICAgICAgY29uc29sZS5pbmZvKG1lc3NhZ2UsIC4uLm9wdGlvbmFsUGFyYW1zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvZ3MgYSBtZXNzYWdlIGF0IGFueSBsZXZlbCBmcm9tIFwiVFJBQ0VcIiB1cHdhcmRzLlxuICAgICAqIEBwYXJhbSBtZXNzYWdlIE1lc3NhZ2UgdG8gbG9nXG4gICAgICogQHBhcmFtIG9wdGlvbmFsUGFyYW1zIEludGVycG9sYXRpb24gdmFsdWVzIGZvciB0aGUgbWVzc2FnZSBpbiBcInByaW50ZlwiIGZvcm1hdFxuICAgICAqL1xuICAgIGxvZyhtZXNzYWdlPzogYW55LCAuLi5vcHRpb25hbFBhcmFtczogYW55W10pIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExvZ0xldmVsID49IExvZ0xldmVsc0VudW0uVFJBQ0UpIHtcblxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzKG1lc3NhZ2UsICdMT0cnKTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSwgLi4ub3B0aW9uYWxQYXJhbXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9ncyBhIG1lc3NhZ2UgYXQgdGhlIFwiVFJBQ0VcIiBsZXZlbC5cbiAgICAgKiBAcGFyYW0gbWVzc2FnZSBNZXNzYWdlIHRvIGxvZ1xuICAgICAqIEBwYXJhbSBvcHRpb25hbFBhcmFtcyBJbnRlcnBvbGF0aW9uIHZhbHVlcyBmb3IgdGhlIG1lc3NhZ2UgaW4gXCJwcmludGZcIiBmb3JtYXRcbiAgICAgKi9cbiAgICB0cmFjZShtZXNzYWdlPzogYW55LCAuLi5vcHRpb25hbFBhcmFtczogYW55W10pIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExvZ0xldmVsID49IExvZ0xldmVsc0VudW0uVFJBQ0UpIHtcblxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzKG1lc3NhZ2UsICdUUkFDRScpO1xuXG4gICAgICAgICAgICBjb25zb2xlLnRyYWNlKG1lc3NhZ2UsIC4uLm9wdGlvbmFsUGFyYW1zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvZ3MgYSBtZXNzYWdlIGF0IHRoZSBcIldBUk5cIiBsZXZlbC5cbiAgICAgKiBAcGFyYW0gbWVzc2FnZSBNZXNzYWdlIHRvIGxvZ1xuICAgICAqIEBwYXJhbSBvcHRpb25hbFBhcmFtcyBJbnRlcnBvbGF0aW9uIHZhbHVlcyBmb3IgdGhlIG1lc3NhZ2UgaW4gXCJwcmludGZcIiBmb3JtYXRcbiAgICAgKi9cbiAgICB3YXJuKG1lc3NhZ2U/OiBhbnksIC4uLm9wdGlvbmFsUGFyYW1zOiBhbnlbXSkge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50TG9nTGV2ZWwgPj0gTG9nTGV2ZWxzRW51bS5XQVJOKSB7XG5cbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cyhtZXNzYWdlLCAnV0FSTicpO1xuXG4gICAgICAgICAgICBjb25zb2xlLndhcm4obWVzc2FnZSwgLi4ub3B0aW9uYWxQYXJhbXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9ncyBhIG1lc3NhZ2UgaWYgYSBib29sZWFuIHRlc3QgZmFpbHMuXG4gICAgICogQHBhcmFtIHRlc3QgVGVzdCB2YWx1ZSAodHlwaWNhbGx5IGEgYm9vbGVhbiBleHByZXNzaW9uKVxuICAgICAqIEBwYXJhbSBtZXNzYWdlIE1lc3NhZ2UgdG8gc2hvdyBpZiB0ZXN0IGlzIGZhbHNlXG4gICAgICogQHBhcmFtIG9wdGlvbmFsUGFyYW1zIEludGVycG9sYXRpb24gdmFsdWVzIGZvciB0aGUgbWVzc2FnZSBpbiBcInByaW50ZlwiIGZvcm1hdFxuICAgICAqL1xuICAgIGFzc2VydCh0ZXN0PzogYm9vbGVhbiwgbWVzc2FnZT86IHN0cmluZywgLi4ub3B0aW9uYWxQYXJhbXM6IGFueVtdKSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRMb2dMZXZlbCAhPT0gTG9nTGV2ZWxzRW51bS5TSUxFTlQpIHtcblxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzKG1lc3NhZ2UsICdBU1NFUlQnKTtcblxuICAgICAgICAgICAgY29uc29sZS5hc3NlcnQodGVzdCwgbWVzc2FnZSwgLi4ub3B0aW9uYWxQYXJhbXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnRzIGFuIGluZGVudGVkIGdyb3VwIG9mIGxvZyBtZXNzYWdlcy5cbiAgICAgKiBAcGFyYW0gZ3JvdXBUaXRsZSBUaXRsZSBzaG93biBhdCB0aGUgc3RhcnQgb2YgdGhlIGdyb3VwXG4gICAgICogQHBhcmFtIG9wdGlvbmFsUGFyYW1zIEludGVycG9sYXRpb24gdmFsdWVzIGZvciB0aGUgdGl0bGUgaW4gXCJwcmludGZcIiBmb3JtYXRcbiAgICAgKi9cbiAgICBncm91cChncm91cFRpdGxlPzogc3RyaW5nLCAuLi5vcHRpb25hbFBhcmFtczogYW55W10pIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExvZ0xldmVsICE9PSBMb2dMZXZlbHNFbnVtLlNJTEVOVCkge1xuICAgICAgICAgICAgY29uc29sZS5ncm91cChncm91cFRpdGxlLCAuLi5vcHRpb25hbFBhcmFtcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFbmRzIGEgaW5kZW50ZWQgZ3JvdXAgb2YgbG9nIG1lc3NhZ2VzLlxuICAgICAqL1xuICAgIGdyb3VwRW5kKCkge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50TG9nTGV2ZWwgIT09IExvZ0xldmVsc0VudW0uU0lMRU5UKSB7XG4gICAgICAgICAgICBjb25zb2xlLmdyb3VwRW5kKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBhIGxvZyBsZXZlbCBuYW1lIHN0cmluZyBpbnRvIGl0cyBudW1lcmljIGVxdWl2YWxlbnQuXG4gICAgICogQHBhcmFtIGxldmVsIExldmVsIG5hbWVcbiAgICAgKiBAcmV0dXJucyBOdW1lcmljIGxvZyBsZXZlbFxuICAgICAqL1xuICAgIGdldExvZ0xldmVsKGxldmVsOiBzdHJpbmcpOiBMb2dMZXZlbHNFbnVtIHtcbiAgICAgICAgbGV0IHJlZmVyZW5jZWRMZXZlbCA9IGxvZ0xldmVscy5maW5kKChjdXJyZW50TGV2ZWw6IGFueSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRMZXZlbC5uYW1lLnRvTG9jYWxlTG93ZXJDYXNlKCkgPT09IGxldmVsLnRvTG9jYWxlTG93ZXJDYXNlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiByZWZlcmVuY2VkTGV2ZWwgPyByZWZlcmVuY2VkTGV2ZWwubGV2ZWwgOiA1O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJzIG5vdGlmaWNhdGlvbiBjYWxsYmFjayBmb3IgbG9nIG1lc3NhZ2VzLlxuICAgICAqIEBwYXJhbSB0ZXh0IE1lc3NhZ2UgdGV4dFxuICAgICAqIEBwYXJhbSBsb2dMZXZlbCBMb2cgbGV2ZWwgZm9yIHRoZSBtZXNzYWdlXG4gICAgICovXG4gICAgbWVzc2FnZUJ1cyh0ZXh0OiBzdHJpbmcsIGxvZ0xldmVsOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5vbk1lc3NhZ2UubmV4dCh7IHRleHQ6IHRleHQsIHR5cGU6IGxvZ0xldmVsIH0pO1xuICAgIH1cbn1cbiJdfQ==